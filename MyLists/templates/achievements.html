{% extends "layout.html" %}

{% block css %}
<style>
table {
    border-collapse: separate;
    border-spacing: 15px;
}

td {
    border-radius: 5px;
}

img {
    cursor: pointer;
}

ul {
    -moz-column-count: 4;
    -moz-column-gap: 20px;
    -webkit-column-count: 4;
    -webkit-column-gap: 20px;
    column-count: 4;
    column-gap: 20px;
}

.details {
    display: none;
}

hr {
    border-top: 1px solid rgba(255, 255, 255, 0.9);
}

.projects {
overflow-x: scroll;
}
</style>
{% endblock css %}


{% block content %}
<div class="container">
    <h2 class="text-center mb-3 mt-4">Anime achievements</h2>
    <hr class="mt-2 mb-3">
    {% if current_user.get_id() == user_id %}
    <div style="font-size: 14pt;" class="text-center mb-5">You have unlocked {{ user_number_achievements }}/{{ user_achievements|length }} achievements.</div>
    {% else %}
    <div style="font-size: 14pt;" class="text-center mb-5">{{ user_name }} has unlocked {{ user_number_achievements }}/{{ user_achievements|length }} achievements.</div>
    {% endif %}
    <div class="projects row text-center p-0">
        <table width="100%">
            <tbody>
            {% for i in range(0, data|length) %}
                <tr>
                    {% for j in range(0, data[0]|length) %}
                    <td id="pr_{{ data[i][j]['image_id'] }}" class="filtered" onclick="test('det_{{ data[i][j]['image_id'] }}', 'pr_{{ data[i][j]['image_id'] }}', 'img_{{ data[i][j]['image_id'] }}')">
                        <span style="font-size: 12pt;">{{ data[i][j]["level"] }}</span><br>
                        <span style="font-size: 12pt;">{{ data[i][j]["time_hours"] }}/{{ data[i][j]["threshold"] }} hours watched</span><br>
                        {% if data[i][j]["time_hours"] >= data[i][j]["threshold"] %}
                        <img id="img_{{ data[i][j]['image_id'] }}" height="100" width="200" src="{{ url_for('static', filename='img/anime_achievements') }}/{{ data[i][j]['image_id'] }}.png"/>
                        {% else %}
                        <img height="100" width="200" style="filter: grayscale(100%);" src="{{ url_for('static', filename='img/anime_achievements') }}/{{ data[i][j]['image_id'] }}.png"/>
                        <span></span>
                        {% endif %}
                    </td>
                    {% endfor %}
                 </tr>
                <tr>
                    {% for j in range(0, data[0]|length) %}
                    <td id="det_{{ data[i][j]['image_id'] }}" class="d-none" colspan="4" style="background: #2c3946; border: black 2px solid;">
                        <div class="p-l-20 p-t-10 p-r-20">
                            <span style="font-size: 14pt;">{{ data[i][j]["title"] }}</span><br>
                            <span style="font-size: 13pt;">{{ data[i][j]["description"] }}</span><br>
                            <div class="m-2"></div>
                            <span style="font-size: 13pt;">Number of anime watched: {{ data[i][j]["anime_watched"] }}</span>
                            <hr class="p-0 m-0">
                            <ul class="p-t-10">
                                {% for k in range(0, data[i][j]["anime_name"]|length) %}
                                <li>
                                    {{ data[i][j]["anime_name"][k] }}
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                    </td>
                    {% endfor %}
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>




        {#{% for i in range(0, user_achievements|length) %}
        <div class="text-center col m-b-30 p-b-0 p-l-20 p-r-20">
            <span>{{ user_achievements[i]["level"] }}</span><br>
            <span>{{ user_achievements[i]["time_hours"] }}/{{ user_achievements[i]["threshold"] }} hours watched</span><br>
            {% if user_achievements[i]["threshold"] < user_achievements[i]["time_hours"] %}
            <a data-toggle="collapse" href="#{{ user_achievements[i]['image_id'] }}">
                <img height="100" width="200" src="{{ url_for('static', filename='img/anime_achievements/') }}{{ user_achievements[i]['image_id'] }}.png" alt=""><br>
            </a>
            {% else %}
            <a data-toggle="collapse" href="#{{ user_achievements[i]['image_id'] }}">
                <img style="filter: grayscale(100%);" height="100" width="200" src="{{ url_for('static', filename='img/anime_achievements/') }}{{ user_achievements[i]['image_id'] }}.png" alt=""><br>
            </a>
            {% endif %}
            <div id="{{ user_achievements[i]['image_id'] }}" class="collapse p-t-10">
                <div class="text text-left">
                    <span style="font-size: 14pt;">{{ user_achievements[i]['title'] }}</span>
                    <p class="text-justify p-0">{{ user_achievements[i]['description'] }}</p>
                    <p class="text-left p-0">NÂ° Anime watched: {{ user_achievements[i]['anime_watched'] }}</p>
                    {% for anime in user_achievements[i]['anime_name'] %}
                    <li class="p-0">{{ anime }}</li>
                    {% endfor %}
                    <div class="m-b-20">----------------------------------------</div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>#}


{% endblock content %}


{% block script %}
<script>
function test(tata, tutu, toto) {
    if ($("#"+tata).hasClass('d-none')) {
        if ($("#"+tata).siblings().hasClass('text-left')) {
            $("#"+tutu).siblings('.filtered').attr('style', 'filter: none;')
            $("#"+tutu).attr('style', 'filter: drop-shadow(5px 5px 5px grey) invert(0%);')
            $("#"+tata).siblings('.text-left').attr('class', 'd-none');
            $("#"+tata).attr('class', 'text-left');
        } else {
            $("#"+tutu).attr('class', 'filtered');
            $("#"+tutu).attr('style', 'filter: drop-shadow(5px 5px 5px grey) invert(0%);')
            $("#"+tata).attr('class', 'text-left');
        }
    } else {
        $("#"+tutu).attr('class', 'filtered');
        $("#"+tutu).attr('style', 'filter: none;')
        $("#"+tata).attr('class', 'd-none');
    }
}
</script>
{% endblock script %}

