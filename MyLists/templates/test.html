{% extends "layout.html" %}
{% block content %}
{% endblock content %}

<script>
$(document).ready(function() {
    $('#button_cat').attr('disabled', true);
    $('#category_name').keyup(function(){
        if($(this).val().length !=0)
            $('#button_cat').attr('disabled', false);
        else
            $('#button_cat').attr('disabled', true);
    })
});


function add_category() {
    var idnumber = Math.floor((Math.random() * 100000) + 1);
    var idnumber_tr = Math.floor((Math.random() * 100000000) + 1);
    var idnumber_cat = Math.floor((Math.random() * 100000000) + 1);
    var text = $("#category_name").val();
    var arrow = idnumber + "_arrow";
    var hidding = idnumber + "_hidding";

    $("#adding_stuff").append(
        "<div id=" + idnumber_cat + ">" +
            "<h2 class='font-weight-light text-center pt-4 mb-0 category-title'>" +
                "<div class='arrow_div float-left'><a class='fas fa-xs fa-trash' onclick='delete_category(\"" + idnumber_cat + "\")'></a></div>" +
                text +
                "<div class='arrow_div float-right'><a class='fas fa-sm fa-chevron-down' id=" + arrow + " onclick='hide(\"" + hidding + "\",\"" + arrow + "\")'></a></div>" +
            "</h2>" +
            "<hr class='mt-2 mb-4'>" +
            "<div id=" + hidding + " class='hide'>" +
                "<a class='fas fa-plus float-right' onclick='add_row(\"" + idnumber + "\")'></a>" +
                "<table class='table table-striped table-sm table-responsive-lg' cellspacing='0' width='100%'>" +
                "<thead>" +
                    "<tr>" +
                        "<th class='th-sm text-light'>Name</th>" +
                        "<th class='th-sm text-light'>Plateform</th>" +
                        "<th class='th-sm text-light'>Time Played</th>" +
                        "<th class='th-sm text-light'>Achievements</th>" +
                        "<th></th>" +
                    "</tr>" +
                "</thead>" +
                "<tbody id=" + idnumber + ">" +
                    "<tr id=" + idnumber_tr + ">" +
                        "<td contenteditable='true' class='text-light'></td>" +
                        "<td contenteditable='true' class='text-light'></td>" +
                        "<td contenteditable='true' class='text-light'></td>" +
                        "<td contenteditable='true' class='text-light'></td>" +
                        "<td class='text-light'><a class='fas fa-minus-circle' onclick='delete_tr(\"" + idnumber_tr + "\")'></a></td>" +
                   "</tr>" +
                "</tbody>" +
                "</table>" +
            "</div>" +
        "</div>"
    );
}


function add_row(id_number) {
    var idnumber_tr = Math.floor((Math.random() * 100000000) + 1);
    $("#"+id_number).append(
        "<tr id=" + idnumber_tr + ">" +
            "<td contenteditable='true' class='text-light'></td>" +
            "<td contenteditable='true' class='text-light'></td>" +
            "<td contenteditable='true' class='text-light'></td>" +
            "<td contenteditable='true' class='text-light'></td>" +
            "<td class='text-light'><a class='fas fa-minus-circle' onclick='delete_tr(\"" + idnumber_tr + "\")'></a></td>" +
       "</tr>"
    );
}


function hide(category, arrow) {
  var category = document.getElementById(category);
  var arrow = document.getElementById(arrow);

  if (category.className === "hide"){
        category.className = "d-none";
        arrow.className = "fas fa-sm fa-chevron-right";
  } else {
        category.className = "hide";
        arrow.className = "fas fa-sm fa-chevron-down";
  }
}


function delete_tr(tr_id) {
    $("#"+ tr_id).remove();
}

function delete_category(cat_id) {
    $("#"+ cat_id).remove();
}

</script>

        beforeSend: function() { $body.addClass("loading"); },
        success: function(response) {
            window.location.replace('/myserieslist'); }

$("#"+drop_id).empty();