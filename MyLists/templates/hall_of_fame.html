{% extends "layout.html" %}

{% block css %}
<!-- MDBootstrap Datatables  -->
<link href="{{ url_for('static', filename='css/addons/datatables.min.css') }}" rel="stylesheet">
{% endblock css %}


{% block content %}
<style>
    table.dataTable thead .sorting:after,
    table.dataTable thead .sorting:before,
    table.dataTable thead .sorting_asc:after,
    table.dataTable thead .sorting_asc:before,
    table.dataTable thead .sorting_asc_disabled:after,
    table.dataTable thead .sorting_asc_disabled:before,
    table.dataTable thead .sorting_desc:after,
    table.dataTable thead .sorting_desc:before,
    table.dataTable thead .sorting_desc_disabled:after,
    table.dataTable thead .sorting_desc_disabled:before {
        bottom: .5em;
    }

    .table {
      color: #fff
    }

    table.table a {
        color: #359aff;
    }

    .table td {
        text-align: center;
        vertical-align: middle;
    }

    .table tr {
        text-align: center;
        vertical-align: middle;
    }

    .current_user {
        background-color: #2c3946;
    }

    a.page-link {
        color: #ffffff !important;
    }

    hr {
        border-top: 1px solid rgba(255, 255, 255, 0.9)
    }
</style>

<h1 class="font-weight-light text-center mt-4 mb-0">SERIES</h1>
<hr class="mt-2 mb-4">

<table id="hall_of_fame_series" class="table table-striped table-sm table-responsive-lg" cellspacing="0" width="100%">
    <thead>
        <tr>
            <th></th>
            <th class="th-sm">Username</th>
            <th class="th-sm">Watching</th>
            <th class="th-sm">Completed</th>
            <th class="th-sm">On Hold</th>
            <th class="th-sm">Random</th>
            <th class="th-sm">Dropped</th>
            <th class="th-sm">Plan to Watch</th>
            <th class="th-sm">Total</th>
            <th class="th-sm">Days spent</th>
            <th class="th-sm">Add friend</th>

        </tr>
    </thead>

    <tbody>
    {% for user in series_data %}
        <tr>
        {% if current_user.get_id() == '1' %}
            <td><img src="{{ user['profile_picture'] }}" alt="profile_picture" style="width: 50px; height: 50px;"></img></td>
            <td><b><a href="/user/series/{{ user['username'] }}">{{ user["username"] }}</a></b></td>
            <td>{{ user["watching"] }}</td>
            <td>{{ user["completed"] }}</td>
            <td>{{ user["onhold"] }}</td>
            <td>{{ user["random"] }}</td>
            <td>{{ user["dropped"] }}</td>
            <td>{{ user["plantowatch"] }}</td>
            <td>{{ user["total"] }}</td>
            <td>{{ user["days"] }}</td>
            <td><a class="fas fa-user-friends" onclick="add_friend('{{ user['username'] }}')"></a></td>

            {% elif user["iscurrentuser"] %}
            <td class="current_user"><img src="{{ user['profile_picture'] }}" alt="profile_picture" style="width: 50px; height: 50px;"></img></td>
            <td class="current_user"><b><a href="/user/series/{{ user['username'] }}">{{ user["username"] }}</a></b></td>
            <td class="current_user">{{ user["watching"] }}</td>
            <td class="current_user">{{ user["completed"] }}</td>
            <td class="current_user">{{ user["onhold"] }}</td>
            <td class="current_user">{{ user["random"] }}</td>
            <td class="current_user">{{ user["dropped"] }}</td>
            <td class="current_user">{{ user["plantowatch"] }}</td>
            <td class="current_user">{{ user["total"] }}</td>
            <td class="current_user">{{ user["days"] }}</td>
            <td class="current_user"></td>

            {% elif user["isprivate"] and not user["isfriend"] %}
            <td><i class="fas fa-times"></i></td>
            <td><b>Anonymous</b></td>
            <td>{{ user["watching"] }}</td>
            <td>{{ user["completed"] }}</td>
            <td>{{ user["onhold"] }}</td>
            <td>{{ user["random"] }}</td>
            <td>{{ user["dropped"] }}</td>
            <td>{{ user["plantowatch"] }}</td>
            <td>{{ user["total"] }}</td>
            <td>{{ user["days"] }}</td>
            <td></td>

            {% else %}
            <td><img src="{{ user['profile_picture'] }}" alt="profile_picture" style="width: 50px; height: 50px;"></img></td>
            <td><b><a href="/user/series/{{ user['username'] }}">{{ user['username'] }}</a></b></td>
            <td>{{ user["watching"] }}</td>
            <td>{{ user["completed"] }}</td>
            <td>{{ user["onhold"] }}</td>
            <td>{{ user["random"] }}</td>
            <td>{{ user["dropped"] }}</td>
            <td>{{ user["plantowatch"] }}</td>
            <td>{{ user["total"] }}</td>
            <td>{{ user["days"] }}</td>
            <td><a class="fas fa-user-friends" onclick="add_friend('{{ user['username'] }}')"></a></td>

        {% endif %}
        </tr>
    {% endfor %}
    </tbody>
</table>

<h1 class="font-weight-light text-center mt-4 mb-0">ANIMES</h1>
<hr class="mt-2 mb-4">

<table id="hall_of_fame_anime" class="table table-striped table-sm table-responsive-lg" cellspacing="0" width="100%">
    <thead>
        <tr>
            <th></th>
            <th class="th-sm">Username</th>
            <th class="th-sm">Watching</th>
            <th class="th-sm">Completed</th>
            <th class="th-sm">On Hold</th>
            <th class="th-sm">Random</th>
            <th class="th-sm">Dropped</th>
            <th class="th-sm">Plan to Watch</th>
            <th class="th-sm">Total</th>
            <th class="th-sm">Days spent</th>
            <th class="th-sm">Add friend</th>
        </tr>
    </thead>

    <tbody>
    {% for user in anime_data %}
        <tr>
        {% if current_user.get_id() == '1' %}
            <td><img src="{{ user['profile_picture'] }}" alt="profile_picture" style="width: 50px; height: 50px;"></img></td>
            <td class="align-middle"><b><a href="/user/anime/{{ user['username'] }}">{{ user["username"] }}</a></b></td>
            <td>{{ user["watching"] }}</td>
            <td>{{ user["completed"] }}</td>
            <td>{{ user["onhold"] }}</td>
            <td>{{ user["random"] }}</td>
            <td>{{ user["dropped"] }}</td>
            <td>{{ user["plantowatch"] }}</td>
            <td>{{ user["total"] }}</td>
            <td>{{ user["days"] }}</td>
            <td><a class="fas fa-user-friends" onclick="add_friend('{{ user['username'] }}')"></a></td>

            {% elif user["iscurrentuser"] %}
            <td class="current_user"><img src="{{ user['profile_picture'] }}" alt="profile_picture" style="width: 50px; height: 50px;"></img></td>
            <td class="current_user"><b><a href="/user/anime/{{ user['username'] }}">{{ user["username"] }}</a></b></td>
            <td class="current_user">{{ user["watching"] }}</td>
            <td class="current_user">{{ user["completed"] }}</td>
            <td class="current_user">{{ user["onhold"] }}</td>
            <td class="current_user">{{ user["random"] }}</td>
            <td class="current_user">{{ user["dropped"] }}</td>
            <td class="current_user">{{ user["plantowatch"] }}</td>
            <td class="current_user">{{ user["total"] }}</td>
            <td class="current_user">{{ user["days"] }}</td>
            <td class="current_user"></td>

            {% elif user["isprivate"] and not user["isfriend"] %}
            <td><i class="fas fa-times"></i></td>
            <td><b>Anonymous</b></td>
            <td>{{ user["watching"] }}</td>
            <td>{{ user["completed"] }}</td>
            <td>{{ user["onhold"] }}</td>
            <td>{{ user["random"] }}</td>
            <td>{{ user["dropped"] }}</td>
            <td>{{ user["plantowatch"] }}</td>
            <td>{{ user["total"] }}</td>
            <td>{{ user["days"] }}</td>
            <td></td>

            {% else %}
            <td><img src="{{ user['profile_picture'] }}" alt="profile_picture" style="width: 50px; height: 50px;"></img></td>
            <td class="align-text-center"><b><a href="/user/anime/{{ user['username'] }}">{{ user['username'] }}</a></b></td>
            <td>{{ user["watching"] }}</td>
            <td>{{ user["completed"] }}</td>
            <td>{{ user["onhold"] }}</td>
            <td>{{ user["random"] }}</td>
            <td>{{ user["dropped"] }}</td>
            <td>{{ user["plantowatch"] }}</td>
            <td>{{ user["total"] }}</td>
            <td>{{ user["days"] }}</td>
            <td><a class="fas fa-user-friends" onclick="add_friend('{{ user['username'] }}')"></a></td>
        {% endif %}
        </tr>
    {% endfor %}
    </tbody>
</table>
{% endblock content %}


{% block script %}
<!-- MDBootstrap Datatables  -->
<script type="text/javascript" src="{{ url_for('static', filename='js/addons/datatables.min.js') }}"></script>

<script>
function add_friend(username) {
    $body = $("body");
    $.ajax ({
        type: "POST",
        url: "/add_friend_hof",
        contentType: "application/json",
        data: JSON.stringify({user_name: username }),
        dataType: "json",
        beforeSend: function() { $body.addClass("loading"); },
        success: function(response) {
            window.location.replace('/hall_of_fame'); }
    });
}

$(document).ready(function () {
$('#hall_of_fame_series').DataTable({
"order": [[ 8, "desc" ], [ 0, "asc" ]]
});
$('.dataTables_length').addClass('bs-select');
});

$(document).ready(function () {
$('#hall_of_fame_anime').DataTable({
"order": [[ 8, "desc" ], [ 0, "asc" ]]
});
$('.dataTables_length').addClass('bs-select');
});
</script>
{% endblock script %}

